# [내부 구현 검증 피하기 글을 읽고 실습 및 기록하기](https://jojoldu.tistory.com/614)

## order-amount-sum 예제 기록

- OrderAmountSum 멤버변수 minusSum, plusSum이 어떻게 계산되는지가 중요한게 아니기 때문에 구현할 필요가없다.

- minusSum, plusSum 멤버 변수를 사용해서 sumAmount를 계산하고 있지만 코드는 얼마든지 변경될 수 있기 때문에 가장 중요한 sumAmount의 계산이 맞는지만 검증하면 된다.

- OrderAmountSum 클래스의 가장 중요한 임무는 클래스의 이름에서도 확인할 수 있듯이 주문의 총 금액을 계산하는것이다. <strong><em>주문의 총 금액을 어떤 방법으로 계산하여도 결과는 항상 같은 값이 나오기 때문에 주문 총 금액을 검증하는 테스트로직 하나면 충분하다.</strong></em>

## 모의 객체 단위 테스트 예제 기록

- order.spec.ts를 보면 findById 함수의 호출 횟수를 테스트하고 있다.

- service로직의 saveOrUpdate 로직이 변경되면 호출 횟수또한 변경될 수 있다.

- 호출 횟수를 검증하기 보다는 해당 함수의 최종 값을 테스트해야한다.

- order-amount-sum 예제와 마찬가지로 결국 내부 로직과는 상관없이 리턴되는 값을 일정하기 때문이다.

## 결론

- 내부 로직을 검증하는 테스트는 내부 로직이 변경됨에 따라 테스트 케이스를 모두 변경해야한다.

- 불필요한 비용을 줄이기 위해서는 구현 검증은 피하고 최종 값을 검증해야 한다.

- 최종 값을 검증하는 로직은 코드 리펙토링에 대한 내성이 높다.
